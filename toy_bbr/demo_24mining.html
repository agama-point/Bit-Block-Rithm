<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>ASH24 PoW Demo</title>

<script src="js/jquery.min.js"></script>
<script src="js/ash24.js"></script>

<style>
body {
    background:#111;
    color:#0f0;
    font-family:monospace;
}
button {
    margin-left:10px;
}
pre {
    margin-top:20px;
}
</style>
</head>
<body>

Base string:
<input type="text" id="base" value="AGAMA">
<button id="start">START</button>

<pre id="output"></pre>

<script>

let running = false;

function mine(prefix, difficulty, callback) {

    let nonce = 1;
    const target = "0".repeat(difficulty);
    const startTime = Date.now();

    function step() {

        if (!running) return;

        for (let i = 0; i < 10000; i++) {

            const candidate = prefix + nonce;
            const hash = ASH24(candidate);
            const hex = hex24(hash).substring(2); // bez 0x

            if (hex.startsWith(target)) {

                const bin = bin24(hash);
                const elapsed = ((Date.now() - startTime) / 1000).toFixed(2);

                callback({
                    candidate,
                    hex,
                    bin,
                    elapsed
                });

                return;
            }

            nonce++;
        }

        setTimeout(step, 0);
    }

    step();
}

$("#start").click(function () {

    if (running) return;

    running = true;
    $("#output").text("");

    const base = $("#base").val();
    let difficulty = 1;

    function nextDifficulty() {

        if (difficulty > 5) {
            running = false;
            return;
        }

        mine(base, difficulty, function (result) {

            const line =
                result.candidate.padEnd(18, " ") + " *   " +
                result.hex.padEnd(6, " ") + "  " +
                result.bin + "   " +
                result.elapsed + "s";

            $("#output").append(line + "\n");

            difficulty++;
            nextDifficulty();
        });
    }

    nextDifficulty();
});

</script>
<hr />
<pre>
AGAMA151418        *   000007  000000000000000000000111
0645657            *   00000f  000000000000000000001111 
</pre>

</body>
</html>
